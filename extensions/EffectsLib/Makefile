# Jamoma Makefile, generated by the Jamoma build system for the platform on which the build was run.
# Edits to this file are NOT under version control and will be lost when the build system is run again.

NAME = EffectsLib
CC_32 = icc -arch i386

CC_64 = icc -arch x86_64

#########################################

SRC = EffectsLib.cpp
SRC += sources/TTBalance.cpp
SRC += sources/TTDegrade.cpp
SRC += sources/TTGain.cpp
SRC += sources/TTLimiter.cpp
SRC += sources/TTOverdrive.cpp
SRC += sources/TTPulseSub.cpp
SRC += sources/TTThru.cpp
SRC += sources/TTWaveshaper.cpp
SRC += tests/TTGain.test.cpp
SRC += tests/TTThru.test.cpp


#########################################

INCLUDES = -Iincludes
INCLUDES += -I../../library/includes
INCLUDES += -I../../../Foundation/library/includes


#########################################

LIBS = ../../../Foundation/library/build/UninstalledProducts/JamomaFoundation.dylib
LIBS += ../../../DSP/library/build/UninstalledProducts/JamomaDSP.dylib


#########################################

OPTIMIZATION_DEBUG = -O0
OPTIMIZATION_RELEASE = -O3

OPTIONS = -dynamiclib -msse3 -mfpmath=sse -gdwarf-2

WARNINGS = -Wall -Wno-unknown-pragmas -Wno-trigraphs
DEFINES = -DTT_PLATFORM_MAC

#########################################

CFLAGS = $(OPTIONS) $(DEFINES) $(INCLUDES) $(WARNINGS)
LDFLAGS = $(LIBS)

#########################################

Debug:
	mkdir -p build
	$(CC_32) $(SRC) $(LDFLAGS) $(CFLAGS) $(OPTIMIZATION_DEBUG) -o build/$(NAME)-i386.ttdylib
	$(CC_64) $(SRC) $(LDFLAGS) $(CFLAGS) $(OPTIMIZATION_DEBUG) -o build/$(NAME)-x86_64.ttdylib
	lipo build/$(NAME)-i386.ttdylib build/$(NAME)-x86_64.ttdylib -create -output build/$(NAME).ttdylib
	cp build/$(NAME).ttdylib /usr/local/jamoma/extensions

Release:
	mkdir -p build
	$(CC_32) $(SRC) $(LDFLAGS) $(CFLAGS) $(OPTIMIZATION_RELEASE) -o build/$(NAME)-i386.ttdylib
	$(CC_64) $(SRC) $(LDFLAGS) $(CFLAGS) $(OPTIMIZATION_RELEASE) -o build/$(NAME)-x86_64.ttdylib
	lipo build/$(NAME)-i386.ttdylib build/$(NAME)-x86_64.ttdylib -create -output build/$(NAME).ttdylib
	cp build/$(NAME).ttdylib /usr/local/jamoma/extensions

clean:
	rm -f *.o
	rm -rf build

install:
	cp build/$(NAME).ttdylib /usr/local/jamoma/extensions
