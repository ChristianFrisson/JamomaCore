max v2;#N vpatcher 503 44 1186 680;#P origin -31 12;#P window setfont "Sans Serif" 9.;#P window linecount 1;#P newex 538 212 88 196617 pv draw-centroid;#P newex 355 58 86 196617 jcom.rgb2luma%;#P newex 355 102 80 196617 s $0_jcom.sum;#P newex 355 80 62 196617 jcom.sum%;#P comment 38 598 75 196617 VIDEO OUTPUT;#N comlet Zoom-rotation output;#P outlet 21 598 15 0;#P newex 22 55 125 196617 jcom.oscroute /genframe;#P comment 39 31 75 196617 INSTRUCTIONS;#P inlet 22 31 15 0;#P comment 374 31 75 196617 VIDEO INPUT;#N comlet Video in;#P inlet 355 31 15 0;#P toggle 359 342 15 0;#P newex 359 362 47 196617 gate 1 0;#P newex 359 381 142 196617 pv draw-window-contraction;#N vpatcher 616 155 1114 529;#P window setfont "Sans Serif" 9.;#P window linecount 1;#N vpatcher 412 123 669 433;#P outlet 64 253 15 0;#P outlet 36 253 15 0;#P inlet 174 25 15 0;#P window setfont "Sans Serif" 9.;#P newex 36 163 27 196617 t b l;#P message 174 168 50 196617 dim \$1 1;#P newex 36 63 29 196617 t b f;#P newex 36 118 51 196617 pack 0 0.;#P number 174 46 35 9 0 0 0 3 0 0 0 221 221 221 222 222 222 0 0 0;#N counter 0 0 200;#X flags 0 0;#P newobj 36 88 83 196617 counter 0 0 200;#P message 36 142 87 196617 setcell \$1 val \$2;#P window linecount 1;#P newex 36 220 53 196617 jit.3m;#P window linecount 0;#P newex 36 195 121 196617 jit.matrix 1 float32 100;#P inlet 36 25 15 0;#P connect 0 0 7 0;#P connect 7 0 4 0;#P connect 4 0 6 0;#P connect 6 0 3 0;#P connect 3 0 9 0;#P fasten 8 0 1 0 179 189 41 189;#P connect 9 0 1 0;#P fasten 9 1 1 0 58 185 41 185;#P connect 1 0 2 0;#P connect 2 0 11 0;#P connect 2 2 12 0;#P connect 7 1 6 1;#P fasten 5 0 4 4 179 74 113 74;#P connect 10 0 5 0;#P connect 5 0 8 0;#P pop;#P newobj 133 259 92 196617 p running_minmax;#N vpatcher 412 123 669 433;#P outlet 64 253 15 0;#P outlet 36 253 15 0;#P inlet 174 25 15 0;#P window setfont "Sans Serif" 9.;#P newex 36 163 27 196617 t b l;#P message 174 168 50 196617 dim \$1 1;#P newex 36 63 29 196617 t b f;#P newex 36 118 51 196617 pack 0 0.;#P number 174 46 35 9 0 0 0 3 0 0 0 221 221 221 222 222 222 0 0 0;#N counter 0 0 200;#X flags 0 0;#P newobj 36 88 83 196617 counter 0 0 200;#P message 36 142 87 196617 setcell \$1 val \$2;#P window linecount 1;#P newex 36 220 53 196617 jit.3m;#P window linecount 0;#P newex 36 195 121 196617 jit.matrix 1 float32 100;#P inlet 36 25 15 0;#P connect 0 0 7 0;#P connect 7 0 4 0;#P connect 4 0 6 0;#P connect 6 0 3 0;#P connect 3 0 9 0;#P fasten 9 1 1 0 58 185 41 185;#P connect 9 0 1 0;#P fasten 8 0 1 0 179 189 41 189;#P connect 1 0 2 0;#P connect 2 0 11 0;#P connect 2 2 12 0;#P connect 7 1 6 1;#P fasten 5 0 4 4 179 74 113 74;#P connect 10 0 5 0;#P connect 5 0 8 0;#P pop;#P newobj 103 236 92 196617 p running_minmax;#N vpatcher 412 123 669 433;#P outlet 64 253 15 0;#P outlet 36 253 15 0;#P inlet 174 25 15 0;#P window setfont "Sans Serif" 9.;#P newex 36 163 27 196617 t b l;#P message 174 168 50 196617 dim \$1 1;#P newex 36 63 29 196617 t b f;#P newex 36 118 51 196617 pack 0 0.;#P number 174 46 35 9 0 0 0 3 0 0 0 221 221 221 222 222 222 0 0 0;#N counter 0 0 200;#X flags 0 0;#P newobj 36 88 83 196617 counter 0 0 200;#P message 36 142 87 196617 setcell \$1 val \$2;#P window linecount 1;#P newex 36 220 53 196617 jit.3m;#P window linecount 0;#P newex 36 195 121 196617 jit.matrix 1 float32 100;#P inlet 36 25 15 0;#P connect 0 0 7 0;#P connect 7 0 4 0;#P connect 4 0 6 0;#P connect 6 0 3 0;#P connect 3 0 9 0;#P fasten 8 0 1 0 179 189 41 189;#P connect 9 0 1 0;#P fasten 9 1 1 0 58 185 41 185;#P connect 1 0 2 0;#P connect 2 0 11 0;#P connect 2 2 12 0;#P connect 7 1 6 1;#P fasten 5 0 4 4 179 74 113 74;#P connect 10 0 5 0;#P connect 5 0 8 0;#P pop;#P newobj 85 215 92 196617 p running_minmax;#N vpatcher 412 123 669 433;#P outlet 64 253 15 0;#P outlet 36 253 15 0;#P inlet 174 25 15 0;#P window setfont "Sans Serif" 9.;#P newex 36 163 27 196617 t b l;#P message 174 168 50 196617 dim \$1 1;#P newex 36 63 29 196617 t b f;#P newex 36 118 51 196617 pack 0 0.;#P number 174 46 35 9 0 0 0 3 0 0 0 221 221 221 222 222 222 0 0 0;#N counter 0 0 200;#X flags 0 0;#P newobj 36 88 83 196617 counter 0 0 200;#P message 36 142 87 196617 setcell \$1 val \$2;#P window linecount 1;#P newex 36 220 53 196617 jit.3m;#P window linecount 0;#P newex 36 195 121 196617 jit.matrix 1 float32 100;#P inlet 36 25 15 0;#P connect 0 0 7 0;#P connect 7 0 4 0;#P connect 4 0 6 0;#P connect 6 0 3 0;#P connect 3 0 9 0;#P fasten 9 1 1 0 58 185 41 185;#P connect 9 0 1 0;#P fasten 8 0 1 0 179 189 41 189;#P connect 1 0 2 0;#P connect 2 0 11 0;#P connect 2 2 12 0;#P connect 7 1 6 1;#P fasten 5 0 4 4 179 74 113 74;#P connect 10 0 5 0;#P connect 5 0 8 0;#P pop;#P newobj 67 191 92 196617 p running_minmax;#P inlet 136 30 15 0;#P user swatch 307 172 83 38;#P window linecount 0;#P newex 136 53 333 196617 jcom.oscroute /contraction/window/reset /contraction/window/color;#P newex 49 162 84 196617 unpack s 0 0 0 0;#P comment 87 141 122 196617 Find the max-contraction;#P number 365 245 35 9 0 0 0 3 0 0 0 221 221 221 222 222 222 0 0 0;#P number 331 245 35 9 0 0 0 3 0 0 0 221 221 221 222 222 222 0 0 0;#P number 297 245 35 9 0 0 0 3 0 0 0 221 221 221 222 222 222 0 0 0;#P newex 297 216 79 196617 unpack 0 0 0;#P newex 13 285 388 196617 pak framerect 0 0 0 0 100 255 100;#P inlet 49 30 15 0;#P outlet 13 331 15 0;#P connect 2 0 0 0;#P connect 1 0 8 0;#P connect 8 1 12 0;#P connect 12 0 2 1;#P connect 8 2 13 0;#P connect 8 3 14 0;#P fasten 13 0 2 2 90 270 126 270;#P connect 8 4 15 0;#P connect 11 0 9 0;#P connect 14 1 2 3;#P connect 15 1 2 4;#P connect 4 0 2 5;#P connect 10 0 3 0;#P connect 9 1 3 0;#P connect 3 0 4 0;#P connect 3 1 5 0;#P connect 5 0 2 6;#P connect 3 2 6 0;#P connect 6 0 2 7;#P pop;#P newobj 347 187 108 196617 p window-contraction;#P window linecount 3;#P comment 347 234 124 196617 The values that draw the windowed contraction rectangle;#P window linecount 1;#P newex 347 212 142 196617 pv draw-window-contraction;#P newex 72 423 112 196617 jcom.passmatrixinfo%;#P newex 165 309 462 196617 jcom.oscroute /contraction/on /contraction/max/on /contraction/window/on /centroid/on;#N vpatcher 681 353 1210 728;#P inlet 168 34 15 0;#P user swatch 324 176 83 38;#P window setfont "Sans Serif" 9.;#P newex 168 57 303 196617 jcom.oscroute /contraction/max/reset /contraction/max/color;#P newex 66 220 84 196617 unpack s 0 0 0 0;#P comment 104 145 122 196617 Find the max-contraction;#P number 382 249 35 9 0 0 0 3 0 0 0 221 221 221 222 222 222 0 0 0;#P number 348 249 35 9 0 0 0 3 0 0 0 221 221 221 222 222 222 0 0 0;#P number 314 249 35 9 0 0 0 3 0 0 0 221 221 221 222 222 222 0 0 0;#P newex 314 220 79 196617 unpack 0 0 0;#P newex 30 289 388 196617 pak framerect 0 0 0 0 100 255 100;#P button 168 98 15 0;#P newex 168 118 64 196617 t 65500 0;#P newex 246 262 40 196617 peak;#P newex 192 262 40 196617 peak;#P newex 138 262 40 196617 trough;#P newex 84 262 40 196617 trough;#P inlet 66 34 15 0;#P outlet 30 335 15 0;#P connect 8 0 0 0;#P connect 1 0 14 0;#P connect 14 1 2 0;#P connect 2 0 8 1;#P connect 6 0 2 1;#P connect 14 2 3 0;#P connect 3 0 8 2;#P connect 17 0 15 0;#P connect 15 0 7 0;#P connect 7 0 6 0;#P connect 6 0 3 1;#P connect 14 3 4 0;#P connect 4 0 8 3;#P connect 6 1 4 1;#P connect 14 4 5 0;#P connect 5 0 8 4;#P connect 6 1 5 1;#P connect 10 0 8 5;#P connect 16 0 9 0;#P connect 15 1 9 0;#P connect 9 0 10 0;#P connect 9 1 11 0;#P connect 11 0 8 6;#P connect 9 2 12 0;#P connect 12 0 8 7;#P pop;#P newobj 214 187 93 196617 p max-contraction;#N vpatcher 654 44 1331 622;#P window setfont "Sans Serif" 9.;#P window linecount 1;#P newex 231 422 52 196617 change 0.;#P newex 98 422 52 196617 change 0.;#P window linecount 2;#P newex 113 460 290 196617 jcom.return contraction/height @range 0. 1. @type msg_float @description "Contraction_height in a range of 0. to 1.";#P newex 98 500 288 196617 jcom.return contraction/width @range 0. 1. @type msg_float @description "Contraction width in a range of 0. to 1.";#P user swatch 414 195 128 32;#P window linecount 0;#P newex 324 55 250 196617 jcom.oscroute /contraction/slide /contraction/color;#P flonum 324 117 35 9 0 0 0 3 0 0 0 221 221 221 222 222 222 0 0 0;#P newex 231 389 77 196617 jcom.autoscale;#P newex 98 389 77 196617 jcom.autoscale;#P newex 231 365 66 196617 jcom.absdiff;#P newex 98 365 66 196617 jcom.absdiff;#P outlet 16 464 15 0;#P inlet 324 25 15 0;#P inlet 26 25 15 0;#N vpatcher 740 320 1033 621;#P window setfont "Sans Serif" 9.;#P window linecount 1;#P newex 40 100 65 196617 jcom.change;#P newex 174 237 53 196617 s $0_dim;#P outlet 93 237 15 0;#P outlet 40 237 15 0;#P inlet 14 30 15 0;#P window linecount 0;#P newex 93 206 39 196617 / 240.;#P newex 40 206 39 196617 / 320.;#P newex 40 160 39 196617 unpack;#P newex 40 124 53 196617 route dim;#P newex 40 78 71 196617 jit.matrixinfo;#P comment 43 31 204 196617 To compensate if incoming video is different than the drawing window of 320x240;#P fasten 6 0 1 0 19 67 45 67;#P connect 1 0 10 0;#P connect 10 0 2 0;#P connect 2 0 3 0;#P connect 3 0 4 0;#P connect 4 0 7 0;#P connect 3 1 5 0;#P connect 5 0 8 0;#P fasten 2 0 9 0 45 146 179 146;#P pop;#P newobj 26 199 65 196617 p adjust-dim;#P number 449 266 35 9 0 0 0 3 0 0 0 221 221 221 222 222 222 0 0 0;#P number 415 266 35 9 0 0 0 3 0 0 0 221 221 221 222 222 222 0 0 0;#P number 381 266 35 9 0 0 0 3 0 0 0 221 221 221 222 222 222 0 0 0;#P newex 381 245 65 196617 unpack 0 0 0;#P newex 75 317 411 196617 pak framerect 0 0 0 0 255 255 84;#P newex 170 283 27 196617 / 1.;#P newex 98 283 27 196617 / 1.;#P newex 316 283 27 196617 / 1.;#P newex 243 283 27 196617 / 1.;#P comment 200 117 50 196617 boundmax;#P comment 91 119 50 196617 boundmin;#P newex 235 97 35 196617 sel -1;#P newex 199 97 35 196617 sel -1;#P newex 127 97 35 196617 sel -1;#P newex 91 97 35 196617 sel -1;#P newex 199 75 46 196617 unpack;#P window linecount 1;#P newex 316 149 55 196617 slide 3. 3.;#P newex 243 149 55 196617 slide 3. 3.;#P newex 170 149 55 196617 slide 3. 3.;#P newex 98 149 55 196617 slide 3. 3.;#P window linecount 0;#P newex 91 75 46 196617 unpack;#P newex 91 55 226 196617 jit.findbounds @min 1 @max 1;#P comment 323 392 298 196617 It might be better to use the frame size to normalize the values.;#P connect 18 0 26 0;#P connect 24 0 23 0;#P fasten 24 0 1 0 31 48 96 48;#P connect 1 0 2 0;#P connect 2 0 8 0;#P connect 8 1 3 0;#P connect 3 0 16 0;#P connect 16 0 27 0;#P connect 27 0 29 0;#P connect 29 0 36 0;#P connect 36 0 34 0;#P fasten 37 0 35 0 236 449 118 449;#P connect 23 0 16 1;#P fasten 31 0 3 1 329 138 131 138;#P connect 2 1 9 0;#P connect 16 0 18 1;#P fasten 31 0 3 2 329 138 159 138;#P connect 14 0 27 1;#P connect 9 1 4 0;#P connect 4 0 17 0;#P connect 23 1 17 1;#P connect 17 0 18 2;#P fasten 31 0 4 1 329 138 203 138;#P connect 1 1 7 0;#P connect 7 0 10 0;#P fasten 31 0 4 2 329 138 231 138;#P connect 17 0 28 0;#P connect 28 0 30 0;#P connect 30 0 37 0;#P connect 7 1 11 0;#P connect 10 1 5 0;#P connect 5 0 14 0;#P connect 14 0 18 3;#P connect 23 0 14 1;#P fasten 31 0 5 1 329 138 276 138;#P fasten 31 0 5 2 329 138 304 138;#P connect 15 0 28 1;#P connect 15 0 18 4;#P connect 11 1 6 0;#P connect 6 0 15 0;#P connect 25 0 32 0;#P connect 32 0 31 0;#P connect 23 1 15 1;#P fasten 31 0 6 1 329 138 349 138;#P fasten 31 0 6 2 329 138 377 138;#P connect 20 0 18 5;#P connect 32 1 19 0;#P connect 33 0 19 0;#P connect 19 0 20 0;#P connect 19 1 21 0;#P connect 21 0 18 6;#P connect 19 2 22 0;#P connect 22 1 18 7;#P pop;#P newobj 104 154 69 196617 p contraction;#P toggle 101 341 15 0;#P newex 101 361 47 196617 gate 1 0;#P toggle 514 349 15 0;#P newex 514 369 47 196617 gate 1 0;#P newex 514 388 88 196617 pv draw-centroid;#P toggle 209 341 15 0;#P newex 209 361 47 196617 gate 1 0;#P newex 209 380 125 196617 pv draw-max-contraction;#P newex 59 461 110 196617 jit.lcd 4 char 320 240;#P newex 101 380 102 196617 pv draw-contraction;#P newex 59 281 40 196617 t b b l;#N vpatcher 430 85 1159 696;#P origin 0 -5;#P window setfont "Sans Serif" 9.;#P window linecount 1;#P newex 416 44 120 196617 jcom.oscroute /centroid;#P outlet 155 551 15 0;#P newex 214 139 35 196617 sel 0.;#P newex 160 139 35 196617 sel 0.;#P toggle 330 109 15 0;#P window linecount 0;#P newex 330 129 47 196617 gate 1 1;#P newex 245 169 55 196617 slide 3. 3.;#P newex 160 169 55 196617 slide 3. 3.;#P newex 330 150 67 196617 slide 10. 10.;#P newex 160 114 64 196617 unpack 0. 0.;#P newex 160 76 112 196617 route location quantity;#P newex 160 45 80 196617 r $0_jcom.sum;#P comment 75 213 109 196617 correct for video size;#P newex 245 238 29 196617 * 1.;#P newex 11 183 64 196617 unpack 0. 0.;#P newex 200 238 29 196617 * 1.;#P window linecount 1;#P newex 11 149 53 196617 r $0_dim;#P window linecount 0;#P newex 416 72 206 196617 jcom.oscroute /size/on /size /color /slide;#P user swatch 529 246 117 58;#N comlet Colour RGB list;#P inlet 416 24 15 0;#P comment 43 359 148 196617 Find centre of circle by subtracting half the size from the upper left coordinates.;#P newex 245 372 27 196617 -;#P newex 200 372 27 196617 -;#P newex 330 256 27 196617 / 2;#P newex 330 227 27 196617 + 5;#P number 385 180 35 9 1 0 1 3 0 0 0 221 221 221 222 222 222 0 0 0;#P newex 330 205 34 196617 * 20.;#P newex 514 313 27 196617 t b l;#P comment 82 116 72 196617 Position (x \, y);#P comment 423 182 26 196617 Size;#P newex 293 256 27 196617 t b i;#P newex 335 479 30 196617 + 10;#P newex 290 479 30 196617 + 10;#P newex 155 520 325 196617 pak paintoval 0 0 0 0 255 255 255;#P connect 17 0 19 0;#P connect 0 0 32 0;#P connect 22 0 23 0;#P connect 23 0 24 0;#P connect 24 0 30 0;#P fasten 30 1 26 0 190 162 165 162;#P connect 26 0 18 0;#P connect 6 0 11 0;#P connect 18 0 11 0;#P connect 3 0 11 0;#P connect 11 0 0 1;#P connect 24 1 31 0;#P connect 10 0 11 1;#P fasten 19 0 18 1 16 235 224 235;#P connect 31 1 27 0;#P connect 27 0 20 0;#P connect 3 0 12 0;#P connect 6 0 12 0;#P connect 20 0 12 0;#P connect 12 0 0 2;#P connect 10 0 12 1;#P fasten 19 1 20 1 70 230 269 230;#P connect 11 0 1 0;#P connect 1 0 0 3;#P fasten 9 0 3 0 335 248 298 248;#P connect 3 1 1 1;#P fasten 16 0 29 0 421 97 335 97;#P connect 29 0 28 0;#P connect 28 0 25 0;#P connect 25 0 7 0;#P connect 7 0 9 0;#P connect 9 0 10 0;#P connect 12 0 2 0;#P connect 2 0 0 4;#P fasten 8 0 7 1 390 200 359 200;#P connect 3 1 2 1;#P connect 23 1 28 1;#P fasten 6 1 0 5 536 507 385 507;#P fasten 16 1 8 0 470 172 390 172;#P connect 14 0 33 0;#P connect 33 0 16 0;#P connect 16 2 6 0;#P connect 15 0 6 0;#P pop;#P newobj 538 187 81 196617 p centroid-stuff;#P window linecount 3;#P comment 214 234 124 196617 The values that draw the maximum contraction rectangle;#P window linecount 1;#P newex 214 212 125 196617 pv draw-max-contraction;#P window linecount 3;#P comment 104 234 105 196617 The values that draw the local contraction rectangle;#P window linecount 1;#P newex 104 212 102 196617 pv draw-contraction;#P connect 7 0 31 0;#P connect 28 0 30 0;#P connect 26 0 5 0;#P connect 30 0 5 0;#P fasten 23 0 7 0 364 412 64 412;#P fasten 8 0 7 0 214 413 64 413;#P fasten 11 0 7 0 519 413 64 413;#P fasten 6 0 7 0 106 413 64 413;#P connect 5 0 7 0;#P connect 19 0 7 0;#P connect 5 2 19 0;#P fasten 18 0 15 0 170 331 106 331;#P connect 15 0 14 0;#P connect 14 0 6 0;#P connect 35 0 16 0;#P connect 16 0 0 0;#P connect 5 1 14 1;#P lcolor 6;#P connect 30 1 16 1;#P connect 30 1 18 0;#P fasten 18 1 10 0 283 331 214 331;#P connect 10 0 9 0;#P connect 9 0 8 0;#P fasten 16 0 17 0 109 177 219 177;#P connect 17 0 2 0;#P connect 5 1 9 1;#P lcolor 6;#P connect 30 1 17 1;#P fasten 16 0 22 0 109 174 352 174;#P connect 22 0 20 0;#P connect 26 0 35 0;#P connect 35 0 33 0;#P connect 33 0 34 0;#P connect 18 2 25 0;#P connect 25 0 24 0;#P connect 24 0 23 0;#P connect 5 1 24 1;#P lcolor 6;#P connect 30 1 22 1;#P connect 18 3 13 0;#P connect 13 0 12 0;#P connect 12 0 11 0;#P connect 30 1 4 0;#P connect 4 0 36 0;#P connect 5 1 12 1;#P lcolor 6;#P pop;