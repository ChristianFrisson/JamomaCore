max v2;#N vpatcher -16 173 903 565;#P origin 0 66;#P window setfont "Sans Serif" 9.;#P newex 252 93 417 196617 jcom.multi.out~.mxt;#P objectname multiout;#P newex 252 313 641 196617 jcom.multi.in~.mxt;#P objectname multiin;#N vpatcher 258 147 890 786;#P window setfont "Sans Serif" 9.;#N vpatcher 27 97 497 505;#P window setfont "Sans Serif" 9.;#P window linecount 1;#P comment 40 142 391 196617 This subpatch is a distance translator from Jamoma to ambiencode~.;#P window linecount 3;#P comment 40 99 393 196617 In the jamoma module/algorithm \, distance is measured in meters. The size of the center circle where spatialisation starts collapsing \, approaching an omni signal \, is defined as /center_distance.;#P window linecount 1;#P newex 68 289 29 196617 * 1.;#P newex 152 307 51 196617 zl join;#P newex 193 283 29 196617 * 1.;#P newex 152 260 51 196617 zl slice 3;#P newex 255 250 31 196617 !/ 1.;#P newex 255 213 77 196617 maximum 0.01;#P inlet 255 182 15 0;#P inlet 68 183 15 0;#P inlet 152 182 15 0;#P outlet 68 352 15 0;#P outlet 152 352 15 0;#P window linecount 0;#P comment 40 48 394 196617 Distance is interpreted differently in ambiencode~ and this jamoma module/algorithm.;#P comment 40 67 392 196617 In ambiencode~ (distance < 1) is the circle where spatial encoding starts collapsing \, instead approaching a omni signal as distance approach zero.;#P connect 5 0 12 0;#P connect 12 0 3 0;#P fasten 7 0 12 1 260 241 92 241;#P connect 4 0 9 0;#P connect 9 0 11 0;#P connect 11 0 2 0;#P connect 9 1 10 0;#P connect 10 0 11 1;#P connect 8 0 10 1;#P connect 6 0 7 0;#P connect 7 0 8 0;#P pop;#P newobj 36 331 188 196617 p distance_translator;#P newex 214 108 29 196617 t b f;#P window linecount 1;#P newex 214 360 59 196617 prepend aed;#P window linecount 0;#P newex 36 214 27 196617 f;#P newex 36 360 67 196617 prepend db_unit;#P newex 144 252 38 196617 zl join;#P newex 327 146 45 196617 t b dump;#P newex 327 113 28 196617 sel 1;#P newex 327 83 53 196617 dspstate~;#N coll ;#P newobj 144 283 53 196617 coll;#P newex 144 223 38 196617 t i l;#P newex 36 83 279 196617 jcom.oscroute /db_drop_off /aed /center_radius;#P inlet 36 56 15 0;#P outlet 36 421 15 0;#P comment 401 87 161 196617 If /order or /voices has caused ambiencode~ to be recreated \, all values have to be resent when audio start to recreate current state. The same holds true if the center_radius is changed.;#P connect 2 0 3 0;#P fasten 8 0 11 0 332 188 41 188;#P connect 3 0 11 0;#P connect 11 0 14 0;#P connect 14 0 10 0;#P connect 12 0 1 0;#P connect 10 0 1 0;#P connect 5 0 14 1;#P connect 3 1 14 1;#P connect 3 1 4 0;#P connect 4 0 9 0;#P fasten 8 1 5 0 367 278 149 278;#P connect 9 0 5 0;#P connect 4 1 9 1;#P connect 3 2 13 0;#P connect 13 1 14 2;#P connect 14 1 12 0;#P connect 6 0 7 0;#P fasten 13 0 8 0 219 139 332 139;#P connect 7 0 8 0;#P pop;#P newobj 179 122 61 196617 p messages;#P objectname messages;#P inlet 43 48 15 0;#N vpatcher 18 97 985 591;#P window setfont "Sans Serif" 9.;#P window linecount 2;#P comment 199 169 134 196617 Changes can not take place while audio is running;#P comment 356 229 151 196617 Only apply script if either voices and/or order is changed;#P window linecount 1;#P newex 147 256 58 196617 unpack 0 0;#P newex 147 232 175 196617 if $i1 != $i3 || $i2 !=$i4 then $i1 $i2;#P window linecount 0;#P newex 441 125 27 196617 t b i;#P inlet 441 44 15 0;#P window linecount 1;#P comment 470 44 100 196617 order;#P window linecount 0;#N vpatcher 44 74 644 474;#P window setfont "Sans Serif" 9.;#P window linecount 1;#N coll ;#T flags 1 0;#T 1 4;#T 2 9;#T 3 16;#P newobj 404 69 53 196617 coll;#P newex 50 130 27 196617 i 16;#P inlet 404 30 15 0;#P window linecount 0;#P newex 80 246 197 196617 sprintf script connect pass[%ld] 0 multiin %ld;#P newex 267 216 27 196617 - 1;#P newex 332 250 218 196617 sprintf script connect encode %ld pass[%ld] 0;#P newex 50 168 40 196617 uzi;#P inlet 50 30 15 0;#P outlet 80 287 15 0;#P connect 1 0 7 0;#P connect 7 0 2 0;#P connect 8 0 7 1;#P connect 2 2 5 0;#P connect 3 0 0 0;#P connect 5 0 0 0;#P fasten 2 2 4 0 85 197 272 197;#P connect 4 0 5 1;#P connect 4 0 3 0;#P connect 6 0 8 0;#P fasten 2 2 3 1 85 194 545 194;#P pop;#P newobj 147 361 116 196617 p connect_from_encode;#N vpatcher 44 74 644 474;#P window setfont "Sans Serif" 9.;#P newex 50 115 27 196617 i 4;#P message 65 211 171 196617 script connect messages 0 encode 0;#P newex 248 175 27 196617 - 1;#P newex 248 207 221 196617 sprintf script connect multiout %ld encode %ld;#P newex 50 141 40 196617 uzi 4;#P inlet 50 30 15 0;#P outlet 65 270 15 0;#P connect 1 0 6 0;#P connect 6 0 2 0;#P connect 2 1 5 0;#P connect 5 0 0 0;#P connect 3 0 0 0;#P fasten 2 2 4 0 85 165 253 165;#P connect 4 0 3 0;#P connect 4 0 3 1;#P pop;#P newobj 271 361 103 196617 p connect_to_encode;#N vpatcher 44 74 644 474;#P inlet 202 30 15 0;#P window setfont "Sans Serif" 9.;#P window linecount 0;#P newex 50 100 27 196617 i 16;#P newex 50 60 27 196617 t b i;#P window linecount 1;#P newex 50 139 363 196617 sprintf script new encode newex 252 153 209 196617 ambiencode~ %ld %ld \;;#P inlet 50 30 15 0;#P outlet 50 168 15 0;#P connect 1 0 3 0;#P connect 3 0 4 0;#P connect 4 0 2 0;#P connect 2 0 0 0;#P connect 5 0 4 1;#P connect 3 1 2 1;#P pop;#P newobj 381 361 72 196617 p new_encode;#N vpatcher 44 74 644 474;#P window setfont "Sans Serif" 9.;#P message 50 50 100 196617 script delete encode;#P inlet 50 30 15 0;#P outlet 50 70 15 0;#P connect 1 0 2 0;#P connect 2 0 0 0;#P pop;#P newobj 479 361 81 196617 p delete_encode;#N vpatcher 44 74 644 474;#P window setfont "Sans Serif" 9.;#P window linecount 0;#P newex 50 129 27 196617 i 16;#P window linecount 1;#N coll ;#T flags 1 0;#T 1 4;#T 2 9;#T 3 16;#P newobj 228 62 53 196617 coll;#P inlet 228 34 15 0;#P window linecount 0;#P newex 50 167 27 196617 t i b;#P window linecount 1;#P newex 80 262 149 196617 sprintf script delete pass[%ld];#P newex 50 235 40 196617 uzi;#P newex 50 200 27 196617 i 16;#P inlet 50 30 15 0;#P outlet 80 284 15 0;#P connect 1 0 8 0;#P connect 8 0 5 0;#P connect 5 1 2 0;#P connect 2 0 3 0;#P connect 7 0 8 1;#P connect 5 0 2 1;#P connect 3 2 4 0;#P connect 4 0 0 0;#P connect 6 0 7 0;#P pop;#P newobj 667 361 71 196617 p delete_pass;#N vpatcher 44 74 630 402;#P window setfont "Sans Serif" 9.;#P window linecount 0;#N coll ;#T flags 1 0;#T 1 4;#T 2 9;#T 3 16;#P newobj 397 62 53 196617 coll;#P newex 50 123 27 196617 i 16;#P inlet 397 23 15 0;#P newex 50 151 40 196617 uzi;#P window linecount 1;#P newex 366 196 117 196617 expr 252 + ($i1-1)*38;#P newex 80 221 296 196617 sprintf script new pass[%ld] newex %ld 230 36 196617 pass~;#P inlet 50 23 15 0;#P outlet 80 251 15 0;#P connect 1 0 6 0;#P connect 6 0 4 0;#P connect 7 0 6 1;#P connect 4 2 2 0;#P connect 2 0 0 0;#P connect 4 2 3 0;#P connect 3 0 2 1;#P connect 5 0 7 0;#P pop;#P newobj 585 361 62 196617 p new_pass;#P newex 30 41 48 196617 loadbang;#P newex 88 102 31 196617 == 0;#P outlet 147 406 15 0;#P newex 147 327 533 196617 t b i i b b b;#P inlet 166 44 15 0;#P newex 166 166 27 196617 i 3;#P newex 147 187 29 196617 gate;#P newex 30 102 32 196617 sel 0;#P newex 30 69 54 196617 dspstate~;#P comment 188 44 100 196617 voices;#P connect 9 0 1 0;#P connect 1 0 2 0;#P fasten 1 0 8 0 35 92 93 92;#P connect 8 0 3 0;#P connect 3 0 19 0;#P connect 19 0 20 0;#P connect 20 0 6 0;#P connect 6 0 15 0;#P fasten 10 0 7 0 590 392 152 392;#P fasten 11 0 7 0 672 392 152 392;#P fasten 12 0 7 0 484 392 152 392;#P fasten 13 0 7 0 386 392 152 392;#P fasten 14 0 7 0 276 392 152 392;#P connect 15 0 7 0;#P connect 5 0 4 0;#P connect 18 0 4 0;#P fasten 2 0 4 0 35 131 171 131;#P connect 4 0 3 1;#P connect 18 1 19 1;#P fasten 20 1 15 1 200 317 258 317;#P fasten 20 0 19 2 152 283 344 283 344 222 262 222;#P connect 6 1 14 0;#P fasten 20 1 19 3 200 280 341 280 341 225 317 225;#P connect 6 2 13 0;#P connect 17 0 18 0;#P fasten 20 1 13 1 200 317 448 317;#P connect 6 3 12 0;#P connect 6 4 10 0;#P fasten 20 1 10 1 200 317 642 317;#P connect 6 5 11 0;#P fasten 20 1 11 1 200 317 733 317;#P pop;#P newobj 43 139 78 196617 p scripting;#N thispatcher;#Q end;#P newobj 43 249 61 196617 thispatcher;#P outlet 252 346 15 0;#P objectname out[1];#N comlet W - omni;#P inlet 252 47 15 0;#P objectname in[1];#P newex 43 96 146 196617 jcom.oscroute /voices /order;#P newex 252 230 36 196617 pass~;#P objectname pass[1];#P newex 290 230 36 196617 pass~;#P objectname pass[2];#P newex 328 230 36 196617 pass~;#P objectname pass[3];#P newex 366 230 36 196617 pass~;#P objectname pass[4];#P newex 404 230 36 196617 pass~;#P objectname pass[5];#P newex 442 230 36 196617 pass~;#P objectname pass[6];#P newex 480 230 36 196617 pass~;#P objectname pass[7];#P newex 518 230 36 196617 pass~;#P objectname pass[8];#P newex 556 230 36 196617 pass~;#P objectname pass[9];#P newex 594 230 36 196617 pass~;#P objectname pass[10];#P newex 632 230 36 196617 pass~;#P objectname pass[11];#P newex 670 230 36 196617 pass~;#P objectname pass[12];#P newex 708 230 36 196617 pass~;#P objectname pass[13];#P newex 746 230 36 196617 pass~;#P objectname pass[14];#P newex 784 230 36 196617 pass~;#P objectname pass[15];#P newex 822 230 36 196617 pass~;#P objectname pass[16];#P newex 252 153 209 196617 ambiencode~ 0 3;#P objectname encode;#P connect 22 0 17 0;#P connect 17 0 21 0;#P connect 21 0 20 0;#P connect 17 1 21 1;#P connect 17 2 23 0;#P connect 18 0 25 0;#P connect 23 0 0 0;#P connect 25 0 0 0;#P connect 0 0 16 0;#P connect 16 0 24 0;#P connect 24 0 19 0;#P connect 15 0 24 1;#P connect 0 1 15 0;#P connect 14 0 24 2;#P connect 13 0 24 3;#P connect 0 2 14 0;#P connect 12 0 24 4;#P connect 25 1 0 1;#P connect 11 0 24 5;#P connect 0 3 13 0;#P connect 10 0 24 6;#P connect 9 0 24 7;#P connect 0 4 12 0;#P connect 8 0 24 8;#P connect 7 0 24 9;#P connect 0 5 11 0;#P connect 25 2 0 2;#P connect 6 0 24 10;#P connect 5 0 24 11;#P connect 0 6 10 0;#P connect 4 0 24 12;#P connect 3 0 24 13;#P connect 0 7 9 0;#P connect 2 0 24 14;#P connect 1 0 24 15;#P connect 0 8 8 0;#P connect 0 9 7 0;#P connect 0 10 6 0;#P connect 0 11 5 0;#P connect 0 12 4 0;#P connect 0 13 3 0;#P connect 0 14 2 0;#P connect 0 15 1 0;#P pop;