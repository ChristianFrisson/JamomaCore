max v2;#N vpatcher 33 59 1172 628;#P origin -186 40;#P hidden toggle 610 578 15 0;#P window setfont "Sans Serif" 9.;#P hidden newex 610 557 38 196617 > -20;#P hidden newex 778 542 29 196617 gate;#P hidden newex 778 589 55 196617 slide 3. 3.;#P flonum 284 300 35 9 0 0 0 3 0 0 0 221 221 221 222 222 222 0 0 0;#P hidden newex 677 324 127 196617 jcom.oscroute /min /max;#P hidden newex 677 300 77 196617 jcom.autoscale;#P hidden newex 325 454 127 196617 jcom.oscroute /min /max;#P hidden newex 325 430 77 196617 jcom.autoscale;#P hidden newex 322 308 127 196617 jcom.oscroute /min /max;#P hidden newex 322 284 77 196617 jcom.autoscale;#P hidden newex 312 204 127 196617 jcom.oscroute /min /max;#P hidden newex 313 180 77 196617 jcom.autoscale;#P comment 183 26 50 196617 Soundfile;#P hidden newex 289 64 45 196617 loadbang;#P hidden newex 1037 194 60 196617 loadmess 1;#P toggle 1037 221 15 0;#P hidden message 1048 178 32 196617 clear;#P hidden newex 1048 156 63 196617 metro 1000;#P hidden newex 778 566 30 196617 ftom;#P user nslider 1037 235 75 198 0 1 0 0;#N vpatcher 164 174 623 410;#P window setfont "Sans Serif" 9.;#P window linecount 3;#P user com 59 41 341 196617 43;#K set 0 16748 25976 24942 25701 29216 21093 26227 30061 8266 25966 29541 28265 30067 11296 19829 29545 25441 27680 18277 29556 30066 25971 8263 29295 30064 11296 21870 26998 25970 29545 29817 8303 26144 20339 27759 8205 10339 10528 12848 12340 11570 12336 14093;#K end;#P window linecount 0;#P user com 59 83 363 196617 229;#K set 0 21875 26990 26400 24942 24940 31091 25970 32288 25209 8276 29289 29556 24942 8266 25960 24942 3373 8272 26996 25448 8297 29472 28005 24947 30066 25956 8311 26996 26656 24942 8289 25697 28788 25956 8310 25970 29545 28526 8303 26144 26217 25700 27749 32288 26226 28525 8269 26988 27749 29216 20597 25451 25972 29797 3373 8258 29289 26472 29806 25971 29472 26995 8301 25953 29557 29285 25632 30569 29800 8308 26725 8307 28773 25460 29281 27680 25445 28276 29295 26980 3373 8268 28533 25710 25971 29472 26995 8301 25953 29557 29285 25632 30569 29800 8308 26725 8307 28773 25460 29281;#K set 100 27680 25966 25970 26489 3373 8270 28521 29545 28261 29555 8297 29472 28005 24947 30066 25956 8311 26996 26656 29800 25888 16993 29291 11618 24947 25956 8307 28773 25460 29281 27680 26220 24948 28261 29555 8301 25953 29557 29285 8232 21318 19753 3373 8276 26725 8290 24946 27424 29539 24940 25888 26995 8289 28192 24949 25705 29807 29305 8301 28516 25964 8307 28773 29810 30061 8292 25955 28525 28783 29545 29801 28526 14880 29800 25888 28277 28002 25970 8303 26144 28533 29808 30068 29472 25701 28773 28260 29472 28526 8308 26725 8307 24941 28780 26990 26400 29281 29797 11808 21608;#K set 200 26995 8310 25970 29545 28526 8297 29472 29541 29728 26223 29216 13364 12592 12320 18554 8303 28268 31020 8289 28260 8303 30068 28789 29811 8242 13600 25185 28260 29486;#K end;#P pop;#P newobj 498 55 51 196617 p ReadMe;#P hidden toggle 270 64 15 0;#P hidden message 270 83 42 196617 loop \$1;#P hidden newex 75 60 27 196617 + 1;#P hidden newex 75 81 61 196617 selector~ 2;#P user ubumenu 75 40 100 196617 0 1 1 0;#X add Mic/line in;#X add Soundfile;#X prefix_set 0 0 <none> 0;#X pattrmode 1;#P toggle 268 24 15 0;#P hidden newex 236 70 30 196617 dac~;#P message 236 24 29 196617 open;#N sfplay~  1 120960 0 ;#P hidden newobj 236 45 43 196617 sfplay~;#P hidden newex 178 81 49 196617 deferlow;#P toggle 75 21 15 0;#P hidden newex 178 43 30 196617 adc~;#P hidden newex 178 100 43 196617 t 1 127;#P hidden newex 178 62 45 196617 loadbang;#P user gain~ 333 23 19 42 158 0 1.071519 7.94321 10.;#P user levelmeter~ 351 23 128 64 20 0 0 0 -48 12 0 0 0 0 0;#X brgb 240 240 240;#X frgb 200 200 200;#X rgb2 0 0 0;#X rgb3 0 0 0;#X rgb4 0 0 0;#X rgb5 255 0 0;#X rgb6 220 100 100;#X rgb7 220 150 80;#X rgb8 220 200 100;#X rgb9 180 210 100;#X markers 12 6 0 -6 -12 -24 -36 -48 0;#X markersused 8;#X done;#P hidden newex 265 558 105 196617 bgcolor 220 220 220;#P window setfont "Sans Serif" 18.;#P comment 482 21 174 196626 SoundAnalysis;#P window setfont "Sans Serif" 9.;#N vpatcher 309 149 1272 705;#P toggle 67 48 15 0;#P window setfont "Sans Serif" 9.;#P newex 89 46 75 196617 receive~ sound;#P window setfont Helvetica 18.;#P comment 218 143 95 1376274 segment~;#P window setfont "Sans Serif" 9.;#P comment 219 166 166 196617 Detects onsets of sounds and notes;#P comment 219 178 107 196617 © 2001 Tristan Jehan;#P user meter~ 82 99 162 112 100 0 168 0 103 103 103 255 153 0 255 0 0 217 217 0 153 186 0 12 3 3 3 3;#P newex 69 75 34 196617 gate~;#P comment 421 300 17 196617 65;#P comment 421 329 17 196617 55;#P comment 421 259 17 196617 90;#P comment 421 359 17 196617 45;#P comment 697 161 222 196617 - Mode using pitch or not (pitch \, nopitch);#P comment 697 229 140 196617 Default window is black70;#P comment 775 125 162 196617 black92 (Blackman-Harris 92 dB);#P comment 775 113 162 196617 black74 (Blackman-Harris 74 dB);#P comment 775 101 162 196617 black70 (Blackman-Harris 70 dB);#P comment 722 326 148 196617 - Loudness variation curve;#P comment 722 314 114 196617 - Onset detection (bang);#P comment 722 338 206 196617 - Last cooked MIDI pitch (only in pitch mode);#P comment 698 296 151 196617 Outputs are from left to right:;#P comment 696 493 232 196617 Note 3: The object uses an efficient real-FFT (twice as fast) written at CNMAT by Adrian Freed;#P comment 697 277 140 196617 Default # peaks to find is 20;#P comment 697 265 140 196617 Default mode is without pitch;#P comment 697 253 131 196617 Default threshold is 100;#P comment 697 149 166 196617 - Segmentation threshold;#P comment 697 173 166 196617 - # of peaks to find (1-100);#P comment 696 414 230 196617 Note 2: Use the delay argument when using this object multiple times in parallel to avoid over loading the CPU with several FFTs occuring at the same time \, i.e. choose 0 \, 1 \, 2 \, etc. FFTs will occur at different times \, each one separated by the time length of a signal vector.;#P comment 697 241 91 196617 Default delay is 0;#P comment 697 217 123 196617 Default FFT size is 1024;#P comment 697 64 174 196617 - FFT size (ms or # of samples);#P comment 697 137 182 196617 - Initial delay (# of signal vectors);#P comment 697 205 143 196617 Default hop size is 512;#P comment 697 22 79 196617 Arguments are:;#P comment 697 40 189 196617 - Buffer size (ms or # of samples);#P comment 697 52 189 196617 - Hop size (ms or # of samples);#P comment 697 76 100 196617 - Type of window;#P comment 714 88 58 196617 rectangular;#P comment 697 193 136 196617 Default buffer size is 1024;#P comment 714 100 59 196617 hanning;#P comment 714 112 62 196617 hamming;#P comment 775 89 162 196617 black62 (Blackman-Harris 62 dB);#P comment 696 382 229 196617 Note 1: Use floats to define sizes in ms and integers to define sizes in # of samples;#P comment 67 482 99 196617 Counter for notes or sounds detected with no notion of pitch;#P comment 88 303 86 196617 Counter for notes detected including possible legatos;#P comment 452 414 229 196617 ¥ When using pitch \, this parameter controls how long to wait after a bang (in ms) and before declaring a new pitch an actual new note. This is due to the fact that there is some latency in finding pitch and you don't want to bang twice. (Default = 150);#P comment 452 351 229 196617 ¥ A threshold for the loudness peak detection (Default = 100);#P comment 452 288 229 196617 ¥ A timer in ms for the half-cosine decay after a loudness peak was detected. (Default = 150);#P hidden newex 280 88 65 196617 unpack 0 0 0;#P hidden message 280 68 68 196617 150 100 150;#P number 69 464 35 9 0 0 0 3 0 0 0 221 221 221 222 222 222 0 0 0;#N counter;#X flags 0 0;#P newobj 69 442 66 196617 counter;#P button 69 400 29 0;#P user multiSlider 253 404 105 107 0. 300. 1 3961 47 0 0 2 0 0 1;#M frgb 0 0 0;#M brgb 255 255 255;#M rgb2 127 127 127;#M rgb3 0 0 0;#M rgb4 37 52 91;#M rgb5 74 105 182;#M rgb6 112 158 18;#M rgb7 149 211 110;#M rgb8 187 9 201;#M rgb9 224 62 37;#M rgb10 7 114 128;#P newex 69 379 194 196617 segment~ 1024 512 2048 black70 1 100;#B color 6;#P number 452 378 35 9 0 0 0 3 0 0 0 221 221 221 222 222 222 0 0 0;#P message 452 397 43 196617 wait \$1;#P number 452 315 35 9 0 0 0 3 0 0 0 221 221 221 222 222 222 0 0 0;#P message 452 334 52 196617 thresh \$1;#P button 90 221 29 0;#P message 32 221 31 196617 set 1;#P number 90 285 35 9 0 0 0 3 0 0 0 221 221 221 222 222 222 0 0 0;#N counter;#X flags 0 0;#P newobj 90 263 66 196617 counter;#P message 452 489 30 196617 print;#P message 452 184 52 196617 npartial 7;#P message 452 116 74 196617 vibrato 50 0.5;#P message 452 48 85 196617 amp-range 40 50;#P comment 452 65 229 196617 ¥ A low and high amplitude threshold: if signal amplitude is below the low threshold \, no pitches or peaks are output. The high threshold is a minimum at which "cooked" outputs may appear.;#P comment 452 133 230 196617 ¥ A period in milliseconds (50) over which the raw pitch may not deviate more than an interval in half-tones (0.5) from the average pitch to report it as a note to the "cooked" pitch outlet.;#P comment 452 201 232 196617 ¥ Higher partials are weighed less strongly than lower ones in determining the pitch -- this specifies the number of the partial (7) which will be weighted half as strongly as the fundamental.;#P comment 452 506 189 196617 ¥ Print the values of these parameters.;#P flonum 314 234 35 9 0 0 0 3 0 0 0 221 221 221 222 222 222 0 0 0;#P user multiSlider 314 261 105 107 45. 90. 1 3961 47 0 0 2 0 0 1;#M frgb 0 0 0;#M brgb 255 255 255;#M rgb2 127 127 127;#M rgb3 0 0 0;#M rgb4 37 52 91;#M rgb5 74 105 182;#M rgb6 112 158 18;#M rgb7 149 211 110;#M rgb8 187 9 201;#M rgb9 224 62 37;#M rgb10 7 114 128;#P message 163 158 31 196617 clear;#P number 452 252 35 9 0 0 0 3 0 0 0 221 221 221 222 222 222 0 0 0;#P message 452 271 43 196617 time \$1;#P user multiSlider 202 261 105 107 0. 300. 1 3961 47 0 0 2 0 0 1;#M frgb 0 0 0;#M brgb 255 255 255;#M rgb2 127 127 127;#M rgb3 0 0 0;#M rgb4 37 52 91;#M rgb5 74 105 182;#M rgb6 112 158 18;#M rgb7 149 211 110;#M rgb8 187 9 201;#M rgb9 224 62 37;#M rgb10 7 114 128;#P hidden message 119 139 26 196617 512;#P number 119 158 35 9 0 1500 3 3 0 0 0 221 221 221 222 222 222 0 0 0;#P hidden newex 280 38 45 196617 loadbang;#P newex 90 200 234 196617 segment~ 1024 512 2048 black70 0 100 pitch 15;#B color 6;#P comment 116 142 42 196617 Hop size;#P connect 80 0 74 0;#P connect 74 0 27 0;#P hidden connect 6 0 27 0;#P hidden connect 16 0 27 0;#P hidden connect 23 0 27 0;#P hidden connect 15 0 27 0;#P hidden connect 17 0 27 0;#P hidden connect 25 0 27 0;#P connect 27 0 29 0;#P fasten 21 0 30 0 37 435 74 435;#P connect 29 0 30 0;#P connect 30 0 31 0;#P connect 74 0 75 0;#P connect 74 0 1 0;#P hidden connect 18 0 1 0;#P fasten 8 0 1 0 168 178 95 178;#P fasten 3 0 1 0 124 178 95 178;#P hidden connect 6 0 1 0;#P hidden connect 15 0 1 0;#P hidden connect 16 0 1 0;#P hidden connect 17 0 1 0;#P hidden connect 23 0 1 0;#P hidden connect 25 0 1 0;#P connect 1 0 22 0;#P connect 22 0 19 0;#P fasten 21 0 19 0 37 257 95 257;#P connect 19 0 20 0;#P connect 79 0 74 1;#P hidden connect 2 0 4 0;#P hidden connect 4 0 3 0;#P connect 1 1 5 0;#P connect 27 1 28 0;#P hidden connect 2 0 32 0;#P hidden connect 32 0 33 0;#P connect 1 2 10 0;#P connect 10 0 9 0;#P hidden connect 33 0 7 0;#P connect 7 0 6 0;#P hidden connect 33 1 24 0;#P connect 24 0 23 0;#P hidden connect 33 2 26 0;#P connect 26 0 25 0;#P pop;#P hidden newobj 404 580 75 196617 p segmentation;#P comment 1003 519 32 196617 -120;#P comment 1003 406 25 196617 0;#P comment 1003 418 19 196617 dB;#P user com 699 395 39 196617 3;#K set 0 20334 29541 29811;#K end;#P user multiSlider 700 405 300 125 -120. 0. 1 3961 15 0 0 2 0 0 0;#M frgb 255 255 255;#M brgb 0 0 0;#M rgb2 127 127 127;#M rgb3 0 0 0;#M rgb4 37 52 91;#M rgb5 74 105 182;#M rgb6 112 158 18;#M rgb7 149 211 110;#M rgb8 187 9 201;#M rgb9 224 62 37;#M rgb10 7 114 128;#P hidden newex 686 414 45 196617 r attack;#P comment 646 414 33 196617 noisy;#P hidden newex 334 90 63 196617 send~ sound;#P number 1002 381 35 9 0 0 8224 3 0 0 0 221 221 221 222 222 222 0 0 0;#P hidden newex 945 338 65 196617 pak 0. 2000.;#P number 1002 272 44 9 0 0 8224 3 0 0 0 221 221 221 222 222 222 0 0 0;#P hidden message 945 357 88 196617 setminmax \$1 \$2;#P comment 1002 286 19 196617 Hz;#P number 646 370 35 9 0 0 8224 3 0 0 0 221 221 221 222 222 222 0 0 0;#P hidden newex 588 318 49 196617 pak 0. 0.;#P number 646 262 44 9 0 0 8225 3 0 0 0 221 221 221 222 222 222 0 0 0;#P hidden message 588 339 88 196617 setminmax \$1 \$2;#P comment 646 276 19 196617 dB;#P comment 1001 247 25 196617 0;#P comment 1001 35 25 196617 20k;#P comment 1001 47 19 196617 Hz;#P flonum 647 506 35 9 0 0 8224 3 0 0 0 221 221 221 222 222 222 0 0 0;#P hidden newex 648 448 65 196617 pak 0. 2000.;#P flonum 647 398 35 9 0 0 8224 3 0 0 0 221 221 221 222 222 222 0 0 0;#P hidden message 648 467 88 196617 setminmax \$1 \$2;#P number 646 234 35 9 0 0 8225 3 0 0 0 221 221 221 222 222 222 0 0 0;#P hidden newex 587 184 65 196617 pak 0. 2000.;#P number 646 127 44 9 0 0 8225 3 0 0 0 221 221 221 222 222 222 0 0 0;#P hidden message 587 203 88 196617 setminmax \$1 \$2;#P comment 646 141 19 196617 Hz;#P user com 344 387 140 196617 15;#K set 0 20079 26995 26990 25971 29472 10323 28773 25460 29281 27680 18028 24948 28261 29555 10496;#K end;#P user com 343 116 145 196617 15;#K set 0 17010 26983 26740 28261 29555 8232 21360 25955 29810 24940 8259 25966 29810 28521 25641;#K end;#P comment 699 23 53 196617 Sonogram;#P user com 344 252 132 196617 13;#K set 0 19567 30052 28261 29555 8232 21360 25955 29810 24940 8261 28261 29287 31017;#K end;#P hidden newex 325 401 58 196617 r noisiness;#P hidden newex 313 159 64 196617 r brightness;#P user multiSlider 345 127 300 125 0. 5899. 1 3705 15 0 0 2 0 0 0;#M frgb 0 0 0;#M brgb 255 255 255;#M rgb2 127 127 127;#M rgb3 0 0 0;#M rgb4 37 52 91;#M rgb5 74 105 182;#M rgb6 112 158 18;#M rgb7 149 211 110;#M rgb8 187 9 201;#M rgb9 224 62 37;#M rgb10 7 114 128;#P hidden newex 322 261 55 196617 r loudness;#P user multiSlider 345 262 300 125 -44. 0. 1 3705 15 0 0 1 0 0 0;#M frgb 0 0 0;#M brgb 255 255 255;#M rgb2 0 0 0;#M rgb3 0 0 0;#M rgb4 37 52 91;#M rgb5 74 105 182;#M rgb6 112 158 18;#M rgb7 149 211 110;#M rgb8 187 9 201;#M rgb9 224 62 37;#M rgb10 7 114 128;#P hidden newex 677 36 75 196617 receive~ sound;#N vpatcher 11 200 1268 642;#P origin -686 0;#P window setfont "Sans Serif" 9.;#P comment 927 209 241 196617 Pitch tracker based on fiddle~ from Miller Puckette;#P comment 927 197 294 196617 Outputs Pitch \, Loudness \, Brightness \, Noisiness and Bark scale;#P window setfont Helvetica 18.;#P comment 925 164 87 1376274 analyzer~;#P window setfont "Sans Serif" 9.;#P comment 927 185 150 196617 FFT-Based Perceptual Analysis;#P comment 927 221 132 196617 © 1997-99 Miller Puckette;#P comment 927 233 107 196617 © 2001 Tristan Jehan;#P newex 378 370 45 196617 s attack;#P newex 378 339 42 196617 t -120.;#P hidden button 320 105 15 0;#P hidden newex 271 127 83 196617 t -36 -30 30 10;#P hidden newex 271 105 45 196617 loadbang;#P comment 282 345 79 196617 Event Detection;#N vpatcher 304 73 683 344;#P origin 0 -22;#P window setfont "Sans Serif" 9.;#P comment 33 220 155 196617 amplitude on a logarithmic curve;#P comment 115 196 104 196617 expanded level \, in dB;#N comlet (float) log10 amplitude;#P outlet 33 194 15 0;#P newex 33 167 29 196617 !- 1.;#P comment 120 112 93 196617 set floor threshold;#P comment 101 87 92 196617 clip if out of range;#P comment 90 64 91 196617 optional gain/trim;#P newex 33 84 61 196617 minimum 0.;#N comlet (float) expanded level;#P outlet 95 194 15 0;#P comment 157 21 73 196617 threshold (dB);#P comment 87 21 74 196617 input gain (dB);#P comment 8 21 78 196617 input level (dB);#P comment 145 170 145 196617 expand to occupy full dB range;#P comment 71 140 280 196617 calculate level as a percentage of the above-threshold range;#P newex 33 60 27 196617 + 0.;#P newex 33 111 81 196617 maximum -120.;#P newex 95 167 45 196617 * -120.;#P newex 33 138 27 196617 / 1.;#N comlet (float) threshold dB;#P inlet 163 36 15 0;#N comlet (float) input gain/trim dB;#P inlet 101 36 15 0;#N comlet (float) dB;#P inlet 33 36 15 0;#P connect 0 0 6 0;#P connect 6 0 13 0;#P connect 13 0 5 0;#P connect 5 0 3 0;#P connect 3 0 17 0;#P connect 17 0 18 0;#P fasten 1 0 6 1 106 56 55 56;#P fasten 2 0 3 1 168 134 55 134;#P fasten 3 0 4 0 38 159 100 159;#P connect 4 0 12 0;#P fasten 2 0 5 1 168 107 109 107;#P pop;#P newobj 245 322 69 196617 p dBexpander;#P comment 71 187 55 196617 Peak Level;#P comment 168 258 75 196617 expanded level;#N vpatcher 304 73 765 326;#P window setfont Arial 10.;#P comment 9 177 158 131137546 amplitude on a logarithmic curve;#P comment 110 162 110 131137546 expanded level \, in dB;#N comlet (float) log10 amplitude;#P outlet 33 162 15 0;#P newex 33 141 27 131137546 !- 1.;#P comment 116 97 92 131137546 set floor threshold;#P comment 101 77 92 131137546 clip if out of range;#P comment 111 56 88 131137546 optional gain/trim;#P newex 33 74 61 131137546 minimum 0.;#N comlet (float) expanded level;#P outlet 95 162 15 0;#P comment 157 21 74 131137546 threshold (dB);#P comment 87 21 75 131137546 input gain (dB);#P comment 8 21 78 131137546 input level (dB);#P comment 145 144 154 131137546 expand to occupy full dB range;#P comment 127 113 291 131137546 calculate level as a percentage of the above-threshold range;#P newex 33 53 27 131137546 + 0.;#P newex 33 95 79 131137546 maximum -120.;#P newex 95 141 40 131137546 * -120.;#P newex 33 116 27 131137546 / 1.;#N comlet (float) threshold dB;#P inlet 163 35 15 0;#N comlet (float) input gain/trim dB;#P inlet 101 35 15 0;#N comlet (float) dB;#P inlet 33 35 15 0;#P connect 0 0 6 0;#P connect 6 0 13 0;#P connect 13 0 5 0;#P connect 5 0 3 0;#P connect 3 0 17 0;#P connect 17 0 18 0;#P connect 1 0 6 1;#P fasten 2 0 3 1 168 112 55 112;#P fasten 3 0 4 0 38 137 100 137;#P connect 4 0 12 0;#P fasten 2 0 5 1 168 91 107 91;#P pop;#P newobj 129 207 69 196617 p dBexpander;#P comment 29 209 98 196617 expand to full range;#P comment 50 168 75 196617 translate to dB;#P newex 217 229 27 196617 t b f;#P comment 452 258 21 196617 ms;#P comment 399 258 21 196617 ms;#P comment 346 258 19 196617 dB;#P comment 284 258 19 196617 dB;#P comment 193 185 19 196617 dB;#P comment 323 185 19 196617 dB;#P comment 252 185 19 196617 dB;#P flonum 271 185 31 9 0 0 8224 3 0 0 0 221 221 221 222 222 222 0 0 0;#N vpatcher 40 55 474 226;#P window setfont Arial 10.;#P comment 9 29 358 131137546 Convert a linear amplitude to amplitude in decibels. 0dB = 1. (full amplitude);#P comment 125 50 169 131137546 amplitude expressed as a decimal \; 1. = full amplitude;#N comlet (float) amplitude;#P outlet 110 105 15 0;#N comlet (float) decibels;#P inlet 110 50 15 0;#P newex 110 76 98 131137546 expr 20.*log10($f1);#P comment 125 94 160 131137546 amplitude expressed in decibels \; 0dB = full amplitude;#P connect 2 0 1 0;#P connect 1 0 3 0;#P pop;#P newobj 129 164 44 196617 p AtodB;#P comment 416 229 44 196617 Min. Off Time;#P comment 350 229 54 196617 Min. Note Duration;#P number 417 258 35 9 0 0 65 3 0 0 0 221 221 221 222 222 222 0 0 0;#P objectname offtime;#P number 362 258 35 9 20 0 65 3 0 0 0 221 221 221 222 222 222 0 0 0;#P objectname mindur;#P comment 289 229 53 196617 Note-on Threshold;#P flonum 300 258 41 9 -120. 0. 3 3 0 0 0 221 221 221 222 222 222 0 0 0;#N vpatcher 39 46 518 512;#P origin 0 1;#P window setfont "Sans Serif" 9.;#P newex 150 304 70 196617 t f b b b;#P newex 272 212 50 196617 f -120.;#P comment 29 246 96 196617 wait at least minimum off time \, then turn note off and begin looking for next event;#P comment 252 376 149 196617 wait at least minimum note time...;#P comment 264 271 103 196617 track amplitude till it stops increasing \, then turn note on and report peak amplitude of attack;#P comment 185 176 90 196617 if note is off and threshold is passed...;#P comment 67 423 84 196617 amplitude of attack;#P comment 185 423 96 196617 1/0 = note-on/note-off;#P comment 398 26 64 196617 min. off time;#P comment 345 14 51 196617 min. note duration;#P comment 280 26 56 196617 threshold dB;#P message 15 249 14 196617 0;#P message 75 203 32 196617 stop;#P newex 15 228 100 196617 delay 50;#P newex 15 203 58 196617 onebang;#P newex 55 174 50 196617 sel 0 1;#P message 190 399 14 196617 1;#P newex 55 153 32 196617 gate;#P newex 132 174 53 196617 if $i2 then $f1;#P newex 190 374 62 196617 delay 100;#P message 170 325 14 196617 1;#P newex 228 128 32 196617 == 0;#P newex 175 153 63 196617 & 1;#P newex 150 283 98 196617 if $i1 then $f2;#P newex 150 262 53 196617 <= -120.;#P newex 193 237 27 196617 f;#P newex 150 212 53 196617 t f b;#N comlet (float) peak attack amplitude;#P outlet 150 423 15 0;#N comlet (1/0) note-on/note-off;#P outlet 170 423 15 0;#N comlet (int) minimum off time in ms;#P inlet 418 39 15 0;#N comlet (int) minimum note duration in ms;#P inlet 360 39 15 0;#N comlet (float) threshold dB;#P inlet 300 39 15 0;#P newex 175 82 50 196617 t f b;#P newex 215 103 50 196617 f -120.;#P newex 175 128 50 196617 > -120.;#N comlet (float) audio peak dB;#P inlet 175 39 15 0;#P comment 152 26 63 196617 audio peak dB;#P comment 11 12 125 196617 Detect an audio event (i.e. a "note") when it surpasses a certain dB threshold;#P fasten 22 0 23 0 60 195 20 195;#P connect 23 0 24 0;#P fasten 25 0 24 0 80 224 20 224;#P connect 24 0 26 0;#P fasten 26 0 20 0 20 268 11 268 11 149 60 149;#P fasten 21 0 20 0 195 418 11 418 11 149 60 149;#P connect 20 0 22 0;#P fasten 18 0 23 1 195 395 125 395 125 199 68 199;#P fasten 22 1 23 1 80 195 68 195;#P connect 22 1 25 0;#P fasten 3 0 20 1 180 149 82 149;#P fasten 8 0 24 1 423 62 110 62;#P fasten 5 0 19 0 180 103 137 103;#P fasten 19 0 11 0 137 207 155 207;#P connect 11 0 13 0;#P connect 13 0 14 0;#P connect 14 0 37 0;#P connect 37 0 10 0;#P connect 37 1 17 0;#P connect 17 0 9 0;#P fasten 26 0 9 0 20 345 175 345;#P connect 2 0 5 0;#P connect 5 0 3 0;#P connect 3 0 15 0;#P connect 15 0 19 1;#P connect 37 2 18 0;#P connect 18 0 21 0;#P connect 11 1 12 0;#P connect 12 0 13 1;#P fasten 36 0 12 1 277 233 215 233;#P fasten 11 0 12 1 155 233 215 233;#P connect 5 1 4 0;#P connect 4 0 3 1;#P fasten 17 0 16 0 175 353 263 353 263 124 233 124;#P fasten 26 0 16 0 20 349 263 349 263 124 233 124;#P connect 16 0 15 1;#P fasten 12 0 14 1 198 258 243 258;#P fasten 7 0 18 1 365 370 247 370;#P fasten 6 0 4 1 305 99 260 99;#P fasten 37 3 36 0 215 325 259 325 259 209 277 209;#P fasten 6 0 36 0 305 99 277 99;#P pop;#P newobj 245 292 70 196617 p detectevent;#P comment 212 171 55 196617 Gain/Trim;#P flonum 212 185 31 9 0 0 8224 3 0 0 0 221 221 221 222 222 222 0 0 0;#P newex 129 144 68 196617 peakamp~ 50;#B color 5;#P comment 228 157 105 196617 Noise Floor Threshold;#P comment 423 342 100 196617 This one has to be sent before the detected one for it to work.;#P newex 552 221 63 196617 unpack 0. 0.;#P newex 549 266 58 196617 arj.smooth;#P newex 549 313 39 196617 s pitch;#P newex 787 267 58 196617 arj.smooth;#P newex 698 242 58 196617 arj.smooth;#P newex 618 267 58 196617 arj.smooth;#P newex 753 288 21 196617 t 0;#P newex 698 267 65 196617 split 0 8000;#P number 907 55 35 9 0 0 0 3 0 0 0 221 221 221 222 222 222 0 0 0;#P newex 907 88 60 196617 pak 100 10;#P number 957 55 35 9 0 0 0 3 0 0 0 221 221 221 222 222 222 0 0 0;#P message 907 113 75 196617 reattack \$1 \$2;#P newex 862 313 35 196617 s bark;#P newex 787 313 58 196617 s noisiness;#P newex 698 313 64 196617 s brightness;#P newex 618 313 55 196617 s loudness;#P message 703 74 35 196617 loud 0;#P message 740 74 35 196617 loud 1;#P comment 703 91 85 196617 ¥ Loudness type;#P message 655 126 30 196617 11.6;#P flonum 655 144 35 9 0 0 0 3 0 0 0 221 221 221 222 222 222 0 0 0;#P message 703 107 44 196617 bright 0;#P message 749 107 44 196617 bright 1;#P message 703 41 34 196617 linear;#P message 739 41 21 196617 log;#P comment 703 58 70 196617 ¥ Output scale;#P comment 703 124 85 196617 ¥ Brightness type;#N vpatcher 30 48 496 744;#P window setfont "Sans Serif" 9.;#P comment 280 222 145 196617 Default window is blackman70;#P comment 154 270 93 196617 blackman92;#P comment 154 258 93 196617 blackman74;#P comment 154 246 93 196617 blackman70;#P comment 44 529 35 196617 Notes:;#P comment 63 438 113 196617 - Noisiness (float) 0-1;#P comment 63 450 201 196617 - Bark decomposition (list of/or 25 floats);#P comment 63 414 100 196617 - Loudness (float);#P comment 63 426 113 196617 - Brightness (float);#P comment 84 342 87 196617 nolist (25 outlets);#P comment 84 354 63 196617 list (default);#P comment 63 330 99 196617 - Bark output format;#P window setfont Helvetica 18.;#P comment 12 21 87 1376274 analyzer~;#P window setfont "Sans Serif" 9.;#P comment 63 70 362 196617 - Pitch is measured with an adapted version of fiddle~ from Miller Puckette;#P comment 63 106 363 196617 - Noisiness is measured with the Bark-based spectral flatness measure (SFM);#P comment 63 118 363 196617 - The bark scale is an auditory model spetrum decomposition: the number of outputs depends on the sampling rate. This version is set for 44100 Hz only \, and outputs 25 bands.;#P comment 63 94 363 196617 - Loudness is measured with the spectral energy;#P comment 63 82 362 196617 - Brightness is measured with the spectral centroid;#P comment 42 54 100 196617 In this version:;#P comment 63 498 205 196617 - Sinusoidal decomposition (freq \, amp) (list);#P comment 63 474 166 196617 - Raw Pitch (Midi \, Amp) (list);#P comment 63 486 152 196617 - Overall amplitude in dB (float);#P comment 63 462 114 196617 - Onset detection (bang);#P comment 63 402 148 196617 - Cooked Pitch (Midi \, Hz) (list);#P comment 44 386 151 196617 Outputs are (from left to right):;#P comment 63 614 360 196617 3- The object uses an efficient real FFT written at CNMAT by Adrian Freed when running on a G3 processor. It uses the altivec optimized Apple real FFT when running on a G4 processor.;#P comment 280 270 140 196617 Default # peaks to output is 0;#P comment 280 258 133 196617 Default # peaks to find is 20;#P comment 280 246 107 196617 Default # pitches is 1;#P comment 63 318 166 196617 - # of peaks to output (1-100);#P comment 63 306 166 196617 - # of peaks to find (1-100);#P comment 63 294 166 196617 - # of pitches to extract (1-3);#P comment 63 562 358 196617 2- Use the delay argument when using this object multiple times in parallel to avoid over loading the CPU with several FFTs occuring at the same time \, e.g. choose 0 \, 1 \, 2 \, etc. FFTs will occur at different times \, each one separated by the time length of a signal vector.;#P comment 280 234 91 196617 Default delay is 0;#P comment 280 210 123 196617 Default FFT size is 1024;#P comment 63 210 174 196617 - FFT size (ms or # of samples);#P comment 63 282 182 196617 - Initial delay (# of signal vectors);#P comment 280 198 143 196617 Default hop size is 512;#P comment 42 170 79 196617 Arguments are:;#P comment 63 186 189 196617 - Buffer size (ms or # of samples);#P comment 63 198 202 196617 - Hop size (ms or # of samples);#P comment 63 222 100 196617 - Type of window;#P comment 80 234 75 196617 rectangular;#P comment 280 186 136 196617 Default buffer size is 1024;#P comment 80 246 59 196617 hanning;#P comment 80 258 62 196617 hamming;#P comment 154 234 93 196617 blackman62;#P comment 63 546 357 196617 1- Use floats to define sizes in ms and integers to define sizes in # of samples;#P pop;#P newobj 843 176 65 196617 p description;#B color 8;#P message 806 98 52 196617 npartial 7;#P message 806 79 82 196617 reattack 100 10;#P message 806 61 74 196617 vibrato 50 0.5;#P message 806 42 85 196617 amp-range 40 50;#P message 618 125 26 196617 512;#P number 618 144 35 9 0 8188 3 3 0 0 0 221 221 221 222 222 222 0 0 0;#P comment 616 130 58 196617 Hop size;#P newex 585 176 245 196617 analyzer~ 2048 512 4096 blackman70 0 1 10 3 list;#B color 6;#P comment 840 161 73 196617 Documentation;#P newex 585 40 75 196617 receive~ sound;#P fasten 0 0 40 0 590 67 134 67;#P connect 40 0 50 0;#P connect 50 0 62 0;#P fasten 41 0 62 1 217 203 163 203;#P fasten 51 0 62 2 276 203 192 203;#P connect 62 1 59 0;#P connect 59 1 43 0;#P connect 43 0 65 0;#P connect 44 0 43 1;#P hidden connect 67 0 68 0;#P hidden connect 69 0 68 0;#P hidden connect 68 0 51 0;#P connect 46 0 43 2;#P hidden connect 68 1 44 0;#P fasten 44 0 65 2 305 283 308 283;#P connect 47 0 43 3;#P hidden connect 68 2 46 0;#P connect 59 1 70 0;#P connect 65 1 71 0;#P connect 70 0 71 0;#P hidden connect 68 3 47 0;#P connect 37 1 36 0;#P connect 36 0 35 0;#P connect 2 0 37 0;#P connect 20 0 2 0;#P connect 21 0 2 0;#P fasten 17 0 2 0 660 167 590 167;#P fasten 4 0 2 0 623 167 590 167;#P connect 6 0 2 0;#P connect 7 0 2 0;#P connect 8 0 2 0;#P connect 9 0 2 0;#P connect 15 0 2 0;#P connect 16 0 2 0;#P connect 13 0 2 0;#P connect 14 0 2 0;#P connect 26 0 2 0;#P connect 0 0 2 0;#P connect 5 0 4 0;#P connect 2 1 32 0;#P connect 32 0 22 0;#P connect 18 0 17 0;#P fasten 2 2 33 0 656 225 703 225;#P connect 33 0 30 0;#P connect 30 0 23 0;#P connect 31 0 23 0;#P connect 30 1 31 0;#P fasten 2 3 34 0 689 219 792 219;#P connect 34 0 24 0;#P fasten 2 4 25 0 722 210 867 210;#P connect 29 0 28 0;#P connect 28 0 26 0;#P connect 27 0 28 1;#P pop;#P hidden newobj 404 561 54 196617 p analysis;#P hidden newex 677 276 39 196617 r pitch;#N vpatcher 30 89 1090 478;#P window setfont "Sans Serif" 9.;#P newex 566 137 45 196617 r attack;#P flonum 566 272 43 9 0 0 0 3 0 0 0 221 221 221 222 222 222 0 0 0;#P newex 566 181 27 196617 gate;#P newex 436 137 63 196617 r pitch-midi;#P newex 436 181 27 196617 gate;#P flonum 436 272 31 9 0 0 8224 3 0 0 0 221 221 221 222 222 222 0 0 0;#P newex 366 137 39 196617 r pitch;#P newex 366 181 27 196617 gate;#P flonum 366 272 31 9 0 0 8224 3 0 0 0 221 221 221 222 222 222 0 0 0;#P newex 40 181 27 196617 gate;#P newex 40 137 54 196617 r centroid;#P number 40 272 35 9 0 0 8352 3 0 0 0 221 221 221 222 222 222 0 0 0;#P message 674 256 359 196617 -32.971783 -24.637337 -20.524914 -26.176474 -34.98518 -35.235893 -33.457436 -29.168552 -36.880424 -38.386875 -37.561596 -37.518135 -39.364742 -43.739395 -42.491814 -44.047512 -44.585262 -45.688904 -48.925526 -51.395912 -50.679478 -53.856987 -55.886772 -59.277302 -71.762749;#P toggle 40 59 15 0;#P newex 674 182 27 196617 gate;#P newex 246 181 27 196617 gate;#P newex 171 181 27 196617 gate;#P newex 111 181 27 196617 gate;#P newex 674 134 35 196617 r bark;#P newex 246 137 58 196617 r noisiness;#P newex 171 137 64 196617 r brightness;#P newex 111 137 55 196617 r loudness;#P flonum 246 272 31 9 0 0 8224 3 0 0 0 221 221 221 222 222 222 0 0 0;#P flonum 171 272 31 9 0 0 8224 3 0 0 0 221 221 221 222 222 222 0 0 0;#P flonum 111 272 31 9 0 0 8224 3 0 0 0 221 221 221 222 222 222 0 0 0;#P newex 674 212 61 196617 prepend set;#P connect 12 0 16 0;#P connect 16 0 14 0;#P connect 15 0 16 1;#P connect 12 0 8 0;#P connect 8 0 1 0;#P connect 4 0 8 1;#P connect 12 0 9 0;#P connect 9 0 2 0;#P connect 5 0 9 1;#P connect 12 0 10 0;#P connect 10 0 3 0;#P connect 6 0 10 1;#P connect 12 0 18 0;#P connect 18 0 17 0;#P connect 19 0 18 1;#P connect 12 0 21 0;#P connect 21 0 20 0;#P connect 22 0 21 1;#P connect 12 0 23 0;#P connect 23 0 24 0;#P connect 25 0 23 1;#P connect 12 0 11 0;#P connect 11 0 0 0;#P connect 0 0 13 0;#P connect 7 0 11 1;#P pop;#P hidden newobj 404 540 55 196617 p numbers;#P hidden newex 32 206 35 196617 r bark;#P hidden newex 32 226 58 196617 r noisiness;#P hidden newex 32 185 64 196617 r brightness;#P hidden newex 32 164 55 196617 r loudness;#P user multiSlider 700 270 300 125 0. 4903. 1 3705 15 0 0 2 0 0 0;#M frgb 0 0 0;#M brgb 255 255 255;#M rgb2 127 127 127;#M rgb3 0 0 0;#M rgb4 37 52 91;#M rgb5 74 105 182;#M rgb6 112 158 18;#M rgb7 149 211 110;#M rgb8 187 9 201;#M rgb9 224 62 37;#M rgb10 7 114 128;#P comment 154 103 53 196617 Brightness;#P comment 288 142 33 196617 noisy;#P user multiSlider 93 127 165 17 0. 22050. 1 2680 47 0 0 2 0 0 1;#M frgb 0 0 0;#M brgb 255 255 255;#M rgb2 127 127 127;#M rgb3 0 0 0;#M rgb4 37 52 91;#M rgb5 74 105 182;#M rgb6 112 158 18;#M rgb7 149 211 110;#M rgb8 187 9 201;#M rgb9 224 62 37;#M rgb10 7 114 128;#P comment 277 423 23 196617 0.2;#P comment 277 351 23 196617 0.4;#P comment 277 279 23 196617 0.6;#P comment 277 209 23 196617 0.8;#P user multiSlider 259 145 17 355 0. 1. 1 2681 47 0 0 2 0 0 1;#M frgb 0 0 0;#M brgb 255 255 255;#M rgb2 127 127 127;#M rgb3 0 0 0;#M rgb4 37 52 91;#M rgb5 74 105 182;#M rgb6 112 158 18;#M rgb7 149 211 110;#M rgb8 187 9 201;#M rgb9 224 62 37;#M rgb10 7 114 128;#P user multiSlider 76 145 17 355 -96. 30. 1 2681 47 0 0 2 0 0 1;#M frgb 0 0 0;#M brgb 255 255 255;#M rgb2 127 127 127;#M rgb3 0 0 0;#M rgb4 37 52 91;#M rgb5 74 105 182;#M rgb6 112 158 18;#M rgb7 149 211 110;#M rgb8 187 9 201;#M rgb9 224 62 37;#M rgb10 7 114 128;#P comment 237 115 39 196617 22 KHz;#P comment 90 115 25 196617 0 Hz;#P comment 161 115 37 196617 10 KHz;#P comment 41 382 36 196617 -60 dB;#P comment 239 503 39 196617 22 KHz;#P comment 184 503 34 196617 3 KHz;#P user multiSlider 94 145 164 355 -96. 30. 25 2937 47 0 1 2 0 0 1;#M frgb 173 173 173;#M brgb 255 255 255;#M rgb2 0 0 0;#M rgb3 0 0 0;#M rgb4 189 166 91;#M rgb5 74 105 182;#M rgb6 112 158 18;#M rgb7 149 211 110;#M rgb8 187 9 201;#M rgb9 224 62 37;#M rgb10 7 114 128;#P comment 90 503 25 196617 0 Hz;#P comment 137 503 32 196617 1 KHz;#P comment 40 491 36 196617 -96 dB;#P comment 43 140 31 196617 30 dB;#P comment 51 223 25 196617 0 dB;#P comment 41 304 36 196617 -30 dB;#P comment 277 493 13 196617 0;#P comment 277 142 13 196617 1;#P comment 289 493 33 196617 peaky;#P comment 29 128 45 196617 Loudness;#P comment 277 130 55 196617 Noisiness;#P user spectroscope~ 700 34 300 225 20 0 1 3 1 1 0 0 0 0 0 0;#X frgb 224 224 224;#X brgb 255 255 255;#X rgb2 0 0 0;#X rgb3 243 204 204;#X rgb4 255 0 0;#X rgb5 184 184 184;#X rgb6 0 0 0;#X rgb7 0 0 0;#X rgb8 255 255 255;#X rgb9 255 0 0;#X rgb10 255 191 0;#X rgb11 0 191 127;#X rgb12 127 0 127;#X rgb13 0 0 0;#X range 0. 1.;#X domain 0. 20000.;#X done;#P user multiSlider 346 398 300 125 0. 0.875557 1 3705 15 0 0 2 0 0 0;#M frgb 0 0 0;#M brgb 255 255 255;#M rgb2 127 127 127;#M rgb3 0 0 0;#M rgb4 37 52 91;#M rgb5 74 105 182;#M rgb6 112 158 18;#M rgb7 149 211 110;#M rgb8 187 9 201;#M rgb9 224 62 37;#M rgb10 7 114 128;#P comment 106 517 149 196617 BARK auditory model spectrum;#P comment 698 259 104 196617 Pitch (F0) Estimation;#P comment 90 23 45 196617 Audio on;#P comment 285 26 29 196617 Play;#P comment 1052 222 58 196617 Auto-clear;#P hidden connect 88 0 90 0;#P hidden connect 108 0 96 0;#P hidden connect 96 0 98 0;#P hidden connect 98 0 97 0;#P hidden connect 35 0 25 0;#P hidden connect 36 0 31 0;#P hidden connect 38 0 18 0;#P hidden connect 89 0 97 1;#P hidden connect 92 0 97 2;#P hidden connect 90 0 89 0;#P hidden connect 87 0 91 0;#P hidden connect 91 0 88 0;#P hidden connect 99 0 92 0;#P hidden connect 95 0 92 0;#P hidden connect 93 0 92 0;#P hidden connect 92 0 94 0;#P hidden connect 92 0 94 1;#P hidden connect 37 0 26 0;#P hidden connect 108 0 100 0;#P hidden connect 100 0 99 0;#P connect 44 0 118 0;#P hidden fasten 110 1 111 0 385 200 317 200;#P hidden connect 46 0 110 0;#P hidden connect 44 0 112 0;#P hidden fasten 112 1 113 0 394 304 327 304;#P hidden connect 47 0 114 0;#P hidden fasten 114 1 115 0 397 450 330 450;#P hidden connect 97 0 86 0;#P hidden connect 88 1 86 0;#P hidden connect 86 0 74 0;#P hidden connect 46 0 45 0;#P hidden connect 53 0 45 0;#P hidden connect 44 0 43 0;#P hidden connect 65 0 43 0;#P hidden connect 47 0 5 0;#P hidden connect 57 0 5 0;#P hidden connect 86 0 85 0;#P hidden connect 56 0 55 0;#P hidden connect 55 0 53 0;#P hidden connect 68 0 67 0;#P hidden connect 67 0 65 0;#P hidden connect 44 0 121 0;#P hidden connect 121 0 122 0;#P hidden connect 66 0 67 1;#P hidden connect 54 0 55 1;#P hidden connect 111 1 54 0;#P hidden connect 111 0 56 0;#P hidden connect 113 1 66 0;#P hidden connect 113 0 68 0;#P hidden connect 115 1 58 0;#P hidden connect 115 0 60 0;#P hidden connect 60 0 59 0;#P hidden connect 59 0 57 0;#P hidden connect 40 0 116 0;#P hidden fasten 116 1 117 0 749 320 682 320;#P hidden connect 42 0 6 0;#P hidden connect 40 0 34 0;#P hidden connect 76 0 77 0;#P hidden connect 58 0 59 1;#P hidden connect 122 0 120 0;#P hidden connect 120 0 103 0;#P hidden connect 103 0 119 0;#P hidden connect 40 0 120 1;#P hidden connect 73 0 72 0;#P hidden connect 72 0 70 0;#P hidden connect 71 0 72 1;#P hidden connect 117 1 71 0;#P hidden connect 117 0 73 0;#P hidden connect 107 0 106 0;#P hidden connect 105 0 102 0;#P hidden connect 119 0 102 0;#P hidden connect 106 0 104 0;#P hidden connect 104 0 105 0;#P pop;